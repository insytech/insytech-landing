---
import BtnLink from "../shared/BtnLink.astro";
import Container from "../shared/Container.astro";
import Brands from "./Brands.astro";
import Badge from "../shared/Badge.astro";
import WaveBackground from "../hero/WaveBackground";
import DashboardShowcase from "../hero/DashboardShowcase";
---

<section class="relative overflow-hidden pt-32 lg:pt-40 pb-0">
    <!-- Text Content -->
    <Container className="relative z-10">
        <div class="max-w-4xl mx-auto text-center space-y-8">
            <!-- Hero Title -->
            <div class="space-y-6">
                <h1
                    class="hero-title opacity-0 text-5xl md:text-7xl font-bold tracking-tight text-heading-1 leading-[1.1]"
                >
                    Soluciones integradas en <span
                        class="animated-gradient-text text-transparent bg-clip-text bg-gradient-to-r from-[#005EB8] via-[#00B5E2] to-[#005EB8] dark:from-[#00D4FF] dark:via-[#5E17EB] dark:to-[#00D4FF]"
                        >ingeniería, software, IA y automatización</span
                    >
                </h1>

                <p
                    class="hero-description opacity-0 text-lg md:text-xl text-heading-3 max-w-2xl mx-auto leading-relaxed"
                >
                    Insytech transforma procesos industriales con soluciones
                    inteligentes y tecnología que se adapta a ti.
                </p>
            </div>

            <!-- CTAs -->
            <div
                class="hero-cta opacity-0 flex flex-col sm:flex-row items-center justify-center gap-4"
            >
                <BtnLink
                    text="Cotizar Proyecto"
                    href="#contact"
                    className="w-full sm:w-auto py-4 px-10 text-white font-semibold transition-transform hover:scale-105"
                    variant="primary"
                />
                <BtnLink
                    text="Ver Servicios"
                    href="#services"
                    className="w-full sm:w-auto py-4 px-10 font-semibold border-2 border-gray-200 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-white/5 transition-all rounded-full"
                    variant="secondary"
                />
            </div>
        </div>
    </Container>

    <!-- FULL-WIDTH Showcase Container - Hidden on Mobile, Premium AR on Desktop -->
    <div
        class="relative mt-0 lg:mt-16 mx-4 sm:mx-4 lg:mx-8 hidden lg:block"
        data-animate="fade-up"
        data-animate-delay="300ms"
    >
        <!-- Wave Background - Full width, rounded container -->
        <div
            class="relative w-full min-h-[600px] lg:h-[600px] rounded-[1rem] overflow-hidden bg-transparent lg:bg-white lg:dark:bg-gray-950"
        >
            <!-- Main Three.js Wave Animation - Hidden on Mobile/Tablet -->
            <WaveBackground
                client:load
                className="absolute inset-0 z-0 hidden lg:block"
                colors={{
                    accent: "#f97316",
                }}
            />

            <!-- Centered Image Card on top of shapes -->
            <div
                class="absolute inset-0 z-10 flex items-center justify-center p-0 lg:px-28 lg:py-32"
            >
                <div class="relative group w-full max-w-3xl lg:max-w-4xl">
                    <!-- Subtle glow on hover -->
                    <div
                        class="absolute -inset-2 bg-white/20 rounded-2xl blur-xl opacity-0 lg:group-hover:opacity-50 transition duration-700 hidden lg:block"
                    >
                    </div>

                    <div class="relative w-full mx-auto z-10">
                        <!-- Main AR Card Container -->
                        <div
                            class="hero-showcase-card relative rounded-xl lg:rounded-2xl shadow-2xl bg-gray-900 aspect-video flex items-center justify-center p-0 overflow-hidden group"
                        >
                            <!-- Dynamic Isometric Dashboard Component -->
                            <DashboardShowcase client:load />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Brands section - Always visible -->
    <Container className="relative z-10 mt-16 sm:mt-24">
        <Brands />
    </Container>

    <script>
        import { gsap } from "gsap";

        const initHero = () => {
            const title = document.querySelector(".hero-title");
            if (!title) return; // Seguridad: Si no hay Hero en esta página, no ejecutar GSAP

            const tl = gsap.timeline({
                defaults: { ease: "power4.out", duration: 1.2 },
            });

            // Set initial state to avoid flicker
            gsap.set([".hero-title", ".hero-description", ".hero-cta"], {
                autoAlpha: 0,
                y: 30,
            });

            // 1. Text Entrance
            tl.to(".hero-title", {
                autoAlpha: 1,
                y: 0,
                duration: 1.5,
                delay: 0.2,
            })
                .to(
                    ".hero-description",
                    { autoAlpha: 1, y: 0, duration: 1.2 },
                    "-=1.1",
                )
                .to(".hero-cta", { autoAlpha: 1, y: 0, duration: 1 }, "-=0.9");

            // 2. Flowing Gradient Animation
            gsap.to(".animated-gradient-text", {
                backgroundPosition: "200% center",
                duration: 8,
                ease: "none",
                repeat: -1,
            });
        };

        // Run on load
        document.addEventListener("DOMContentLoaded", initHero);
    </script>

    <style>
        .hero-bg-circle {
            transform: scale(0.85);
            will-change: transform, opacity;
        }

        .animated-gradient-text {
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            display: inline-block;
            will-change: background-position;
        }

        .hero-showcase-card {
            background-image: none;
            background-size: cover;
            background-position: center;
        }

        @media (min-width: 1024px) {
            .hero-showcase-card {
                background-image: url("/images/hero-insytech.webp");
                background-color: #020617; /* Fallback dark color */
            }
        }
    </style>
</section>
